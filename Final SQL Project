SELECT DISTINCT FirstName || " " || LastName AS FullName, Customerid, Country
FROM customers LEFT JOIN invoices ON customers.Customerid = invoices.Customerid
WHERE Country != "USA"
GROUP BY FullName;

SELECT DISTINCT FirstName || " " || LastName AS FullName, Customerid, Country
FROM customers LEFT JOIN invoices ON customers.Customerid = invoices.Customerid
WHERE Country = "Brazil"
GROUP BY FullName;

SELECT FirstName ||" "|| LastName AS FullName, Invoiceid, InvoiceDate, BillingCountry
FROM invoices LEFT JOIN customers ON customers.Customerid = invoices.Customerid
WHERE customers.Country ="Brazil"
GROUP BY FullName;

SELECT * 
FROM employees
WHERE Title Like "%Sales%Agent%"
GROUP BY LastName;

SELECT DISTINCT BillingCountry
FROM invoices
ORDER BY  BillingCountry;

SELECT (SELECT DISTINCT employees.FirstName||" "|| employees.LastName AS FullName, Customerid
        FROM employees JOIN customers 
        WHERE Title LIKE "%Sales%Agent%") AS table1 , Invoiceid
FROM invoices LEFT JOIN table1 ON table1.Customerid=invoices.Customerid
GROUP BY FullName;

SELECT DISTINCT  employees.FirstName||" "|| employees.LastName AS FullName, Customerid, Invoiceid
FROM customers 
    JOIN employees ON SupportRepId= EmployeeID 
    JOIN invoices ON invoices.CustomerId= customers.CustomerId 
GROUP BY FullName;

SELECT customers.FirstName ||" "|| customers.LastName AS Customer_FullName, SUM(invoice_items.Quantity*invoice_items.UnitPrice) AS invoice_total, Country, employees.FirstName||" "|| employees.LastName AS Sales_Agent_FullName
FROM employees
    JOIN customers ON SupportRepId = EmployeeId
    JOIN invoices ON invoices.CustomerId = customers.CustomerId
    JOIN invoice_items ON invoices.InvoiceId = invoice_items.InvoiceId
WHERE Title LIKE "%Sales%Agent%"
GROUP BY Customer_FullName;

SELECT COUNT(*)
FROM invoices
WHERE InvoiceDate LIKE "2009%";

SELECT SUM(Quantity*UnitPrice)
FROM invoice_items LEFT JOIN invoices ON invoice_items.InvoiceId = invoices.InvoiceId
WHERE InvoiceDate LIKE "2009%";

SELECT tracks.Name, InvoiceId
FROM invoice_items INNER JOIN tracks ON invoice_items.TrackId = tracks.TrackId;

SELECT tracks.*, albums.Title, media_types.Name, genres.Name
FROM tracks
    JOIN albums ON tracks.AlbumId = albums.AlbumId
    JOIN genres ON tracks.GenreId = genres.GenreId
    JOIN media_types ON tracks.MediaTypeId = media_types.MediaTypeId
ORDER BY tracks.Name;

SELECT SUM(Quantity), employees.FirstName||" "|| employees.LastName AS FullName
FROM customers
    LEFT JOIN employees ON SupportRepId = EmployeeId
    LEFT JOIN invoices ON customers.CustomerId =invoices.CustomerId
    LEFT JOIN invoice_items ON invoices.InvoiceId = invoice_items.InvoiceId
WHERE
 employees.Title LIKE "%Sales%Agent%"
GROUP BY FullName;

SELECT (SUM(invoice_items.UnitPrice*invoice_items.Quantity)), employees.FirstName ||" "|| employees.LastName AS FullName
FROM invoice_items 
    LEFT JOIN invoices ON invoice_items.InvoiceId = invoices.InvoiceId
    LEFT JOIN customers ON invoices.CustomerId = customers.CustomerId
    LEFT JOIN employees ON EmployeeId = SupportRepId
WHERE InvoiceDate LIKE "2009%"
GROUP BY FullName
